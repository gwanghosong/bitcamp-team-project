<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.eomcs.lms.dao.TeamRecruitDao">

  <resultMap type="TeamRecruit" id="teamRecruitMap">
    <id column="rcrm_id" property="teamNo" />
    <result column="tm_id" property="teamId" />
    <result column="titl" property="teamTitle" />
    <result column="vw_cnt" property="teamViewCount" />
    <result column="cdt" property="teamCreatedDate" />
    <result column="rcrm_stat" property="teamRcrmStatus" />
    <result column="cont" property="teamContents" />

    <association property="team" javaType="Team">
      <id column="tm_id" property="teamId" />
      <result column="area" property="teamArea" />
      <result column="name" property="teamName" />
    </association>
    
    <association property="teamTypeSports" javaType="teamTypeSports">
      <id column="spt_clsf_id" property="teamSportsTypeId" />
      <result column="spt_clsf_name" property="teamSportsType" />
    </association>

  </resultMap>
  
 
  <select id="findAll" resultMap="teamRecruitMap" parameterType="map">
    select
      rcrm_id,
      titl,
      area,
      name,
      r.cdt,
      rcrm_stat,
      vw_cnt,
      spt_clsf_name
    from
      rcrm r
      left outer join tm t on r.tm_id = t.tm_id
      left outer join spt_clsf s on s.spt_clsf_id = t.spt_clsf_id
  </select>
  
  <select id="findByNo" resultMap="teamRecruitMap" parameterType="int"> 
     select
      rcrm_id,
      titl,
      area,
      name,
      rcrm_stat,
      vw_cnt,
      spt_clsf_name
    from
      rcrm r
      left outer join tm t on r.tm_id = t.tm_id
      left outer join spt_clsf s on s.spt_clsf_id = t.spt_clsf_id
    where
      r.rcrm_id = #{value};
    
  </select>
  
  <update id="increaseCount" parameterType="int">
    update rcrm
    set 
      vw_cnt = vw_cnt + 1 
    where rcrm_id = #{value}
  </update>


</mapper>

















